# å¡ç‰Œæ¸¸æˆç¨‹åºè®¾è®¡æ–‡æ¡£

åŸºäºCocos2d-xçš„å¡ç‰ŒåŒ¹é…æ¸¸æˆï¼Œå°†æ¸¸æˆä¸»ç•Œé¢åˆ’åˆ†ä¸ºä¸»ç‰ŒåŒºã€åº•ç‰ŒåŒºå’Œå¤‡ç”¨ç‰ŒåŒºä¸‰ä¸ªåŠŸèƒ½åŒºåŸŸã€‚é‡‡ç”¨**ç»Ÿä¸€**çš„ç®¡ç†æ¶æ„ï¼Œå®ç°äº†ä¸‰ä¸ªå¡ç‰ŒåŒºåŸŸçš„ä¸€è‡´æ€§è®¾è®¡ã€‚

## æ–°åŠ å¡ç‰Œæ•°é‡

ç›´æ¥æ›´æ”¹GameConfig.hä¸­çš„å¯¹åº”ç‰Œç§çš„CARD_COUNTå‚æ•°å³å¯ã€‚
> åœ¨GameConfigä¸­å¯ä»¥è®¾ç½®æ¸¸æˆçš„æ‰€æœ‰ç›¸å…³å‚æ•°ï¼ŒåŒ…æ‹¬ç‰Œçš„æ•°é‡ã€ç‰Œå †å¤§å°ã€ç‰Œå †ä½ç½®ã€ç‰Œå †é—´è·ç­‰ã€‚


---
AI - Visualization
## ğŸ”„ **ç©å®¶æ“ä½œå›é¦ˆæµç¨‹å›¾**

### **ä¸»ç‰Œç‚¹å‡»åŒ¹é…æµç¨‹**

```mermaid
graph TD
    A[ç©å®¶ç‚¹å‡»ä¸»ç‰Œ] --> B[CardView.cpp::onTouchBegan]
    B --> C[CardViewManager.cpp::onCardClicked]
    C --> D[GameController.cpp::onCardClicked]
    D --> E{åˆ¤æ–­å¡ç‰Œç±»å‹}

    E -->|ä¸»ç‰Œ| F[GameController.cpp::handleCardMatch]
    F --> G[GameLogicService.cpp::processCardMatch]
    G --> H{åŒ¹é…æˆåŠŸ?}

    H -->|æˆåŠŸ| I[GameController.cpp::handleMatchSuccess]
    I --> J[GameModel.cpp::removeFromMainStack]
    I --> K[GameModel.cpp::addToBottomStack]
    I --> L[CardViewManager.cpp::playMatchAnimation]
    L --> M[CardViewManager.cpp::syncCardStatesOnly]

    H -->|å¤±è´¥| N[GameController.cpp::handleMatchFailure]
    N --> O[CardViewManager.cpp::playMismatchAnimation]
```

### **åº•ç‰Œåˆ‡æ¢æµç¨‹**

```mermaid
graph TD
    A[ç©å®¶ç‚¹å‡»åº•ç‰Œ] --> B[CardView.cpp::onTouchBegan]
    B --> C[CardViewManager.cpp::onCardClicked]
    C --> D[GameController.cpp::onCardClicked]
    D --> E[GameController.cpp::handleBottomCardClick]

    E --> F[GameModel.cpp::moveBottomToSpare]
    E --> G[CardViewManager.cpp::calculateSpareCardPosition]
    E --> H[CardView.cpp::flipCardWithAnimation]
    H --> I[CardViewManager.cpp::syncCardStatesOnly]
```

### **å¤‡ç”¨ç‰Œæ¿€æ´»æµç¨‹**

```mermaid
graph TD
    A[ç©å®¶ç‚¹å‡»å¤‡ç”¨ç‰Œ] --> B[CardView.cpp::onTouchBegan]
    B --> C[CardViewManager.cpp::onCardClicked]
    C --> D[GameController.cpp::onCardClicked]
    D --> E[GameController.cpp::handleSpareCardClick]

    E --> F[GameModel.cpp::moveSpareToBottom]
    E --> G[CardViewManager.cpp::calculateBottomCardPosition]
    E --> H[CardView.cpp::flipCardWithAnimation]
    H --> I[CardViewManager.cpp::syncCardStatesOnly]
```

### **å…³é”®æ–¹æ³•è°ƒç”¨é“¾**

#### **ğŸ¯ ç‚¹å‡»äº‹ä»¶ä¼ é€’é“¾**

```
ç”¨æˆ·ç‚¹å‡» â†’ CardView::onTouchBegan()
        â†’ CardViewManager::onCardClicked()
        â†’ GameController::onCardClicked()
        â†’ GameController::handle[CardType]Click()
```

#### **ğŸ”„ æ•°æ®æ›´æ–°é“¾**

```
GameModel::removeFromMainStack() â†’ GameModel::addToBottomStack()
                                â†’ CardViewManager::syncCardStatesOnly()
                                â†’ CardView::updateDisplay()
```

#### **ğŸ¬ åŠ¨ç”»æ‰§è¡Œé“¾**

```
GameController::handleMatchSuccess() â†’ CardViewManager::playMatchAnimation()
                                   â†’ CardView::runAction()
                                   â†’ Cocos2d-xåŠ¨ç”»ç³»ç»Ÿ
```


