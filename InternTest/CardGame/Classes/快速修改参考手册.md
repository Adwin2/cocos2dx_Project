# å¿«é€Ÿä¿®æ”¹å‚è€ƒæ‰‹å†Œ

## ğŸš€ ä¸€åˆ†é’Ÿå¿«é€Ÿå®šä½

### æˆ‘æƒ³ä¿®æ”¹...

| ä¿®æ”¹å†…å®¹ | æ–‡ä»¶ä½ç½® | å¤§æ¦‚è¡Œæ•° | éœ€è¦é‡æ–°ç¼–è¯‘ |
|---------|---------|---------|-------------|
| çª—å£å¤§å° | `AppDelegate.cpp` | 80-120 | âœ… |
| å¡ç‰Œé—´è· | `GameConfig.cpp` | 15-20 | âœ… |
| èƒŒæ™¯é¢œè‰² | `GameConfig.cpp` | 25-30 | âœ… |
| åŒ¹é…è§„åˆ™ | `GameLogicService.cpp` | 15-25 | âœ… |
| å¾—åˆ†æ•°å€¼ | `GameConfig.cpp` | 5-10 | âœ… |
| å¡ç‰Œå›¾ç‰‡ | `ResourceService.cpp` + `Resources/` | 10-15 | âœ… |
| å­—ä½“æ–‡ä»¶ | `GameConfig.cpp` | 35-40 | âœ… |
| åŠ¨ç”»é€Ÿåº¦ | `GameConfig.cpp` | 8-12 | âœ… |

## ğŸ“ å¸¸ç”¨ä»£ç ç‰‡æ®µ

### 1. ä¿®æ”¹çª—å£å¤§å°
```cpp
// æ–‡ä»¶: AppDelegate.cpp (çº¦ç¬¬90è¡Œ)
glview->setFrameSize(1920, 1080);  // æ”¹ä¸º1920x1080
director->getOpenGLView()->setDesignResolutionSize(1920, 1080, ResolutionPolicy::SHOW_ALL);
```

### 2. ä¿®æ”¹å¡ç‰Œå¸ƒå±€
```cpp
// æ–‡ä»¶: GameConfig.cpp
const float GameConfig::CardSettings::CARD_SPACING = 150.0f;  // å¡ç‰Œé—´è·
const Vec2 GameConfig::PositionSettings::BOTTOM_CARD_OFFSET = Vec2(200, 0);  // åº•ç‰Œä½ç½®
```

### 3. ä¿®æ”¹é¢œè‰²ä¸»é¢˜
```cpp
// æ–‡ä»¶: GameConfig.cpp
const Color3B GameConfig::ColorSettings::BACKGROUND_COLOR = Color3B(30, 30, 60);  // æ·±è“èƒŒæ™¯
const Color3B GameConfig::ColorSettings::WIN_TEXT_COLOR = Color3B::YELLOW;  // é»„è‰²èƒœåˆ©æ–‡å­—
```

### 4. ä¿®æ”¹æ¸¸æˆè§„åˆ™
```cpp
// æ–‡ä»¶: GameLogicService.cpp (çº¦ç¬¬18è¡Œ)
bool GameLogicService::canMatch(const CardModel& card1, const CardModel& card2)
{
    // åŸè§„åˆ™: ç›¸åŒæ•°å€¼æˆ–èŠ±è‰²
    // return (card1.getValue() == card2.getValue()) || (card1.getSuit() == card2.getSuit());
    
    // æ–°è§„åˆ™: åªæœ‰ç›¸åŒæ•°å€¼
    return (card1.getValue() == card2.getValue());
    
    // æ–°è§„åˆ™: åªæœ‰ç›¸åŒèŠ±è‰²
    // return (card1.getSuit() == card2.getSuit());
    
    // æ–°è§„åˆ™: ç›¸é‚»æ•°å€¼ä¹Ÿå¯åŒ¹é…
    // int diff = abs(card1.getValue() - card2.getValue());
    // return (diff == 0 || diff == 1);
}
```

### 5. ä¿®æ”¹å¾—åˆ†ç³»ç»Ÿ
```cpp
// æ–‡ä»¶: GameConfig.cpp
const int GameConfig::GameSettings::MATCH_SCORE = 20;  // åŸºç¡€å¾—åˆ†æ”¹ä¸º20

// æ–‡ä»¶: GameLogicService.cpp (çº¦ç¬¬55è¡Œ)
int GameLogicService::calculateMatchScore(const CardModel& card1, const CardModel& card2, int level)
{
    int baseScore = GameConfig::GameSettings::MATCH_SCORE;
    
    // ç›¸åŒæ•°å€¼åŒå€å¾—åˆ†
    if (card1.getValue() == card2.getValue()) {
        baseScore *= 2;
    }
    
    // å…³å¡å€æ•°
    baseScore *= level;
    
    return baseScore;
}
```

### 6. æ·»åŠ æ–°çš„å¡ç‰ŒåŠ¨ç”»
```cpp
// æ–‡ä»¶: CardView.cpp (çº¦ç¬¬150è¡Œ)
void CardView::playCustomAnimation()
{
    // æ—‹è½¬åŠ¨ç”»
    auto rotate = RotateBy::create(0.5f, 360);
    
    // ç¼©æ”¾åŠ¨ç”»
    auto scaleUp = ScaleTo::create(0.2f, 1.2f);
    auto scaleDown = ScaleTo::create(0.2f, 1.0f);
    auto scaleSeq = Sequence::create(scaleUp, scaleDown, nullptr);
    
    // ç»„åˆåŠ¨ç”»
    auto spawn = Spawn::create(rotate, scaleSeq, nullptr);
    this->runAction(spawn);
}
```

## ğŸ”§ æ·»åŠ æ–°åŠŸèƒ½æ¨¡æ¿

### æ·»åŠ æ–°çš„æœåŠ¡ç±»
```cpp
// 1. åˆ›å»ºå¤´æ–‡ä»¶: Classes/services/NewService.h
#ifndef __NEW_SERVICE_H__
#define __NEW_SERVICE_H__

class NewService
{
public:
    static void doSomething();
private:
    NewService() = delete;
};

#endif

// 2. åˆ›å»ºå®ç°æ–‡ä»¶: Classes/services/NewService.cpp
#include "NewService.h"

void NewService::doSomething()
{
    // å®ç°åŠŸèƒ½
}

// 3. ä¿®æ”¹ CMakeLists.txtï¼Œæ·»åŠ ï¼š
// Classes/services/NewService.cpp (åœ¨GAME_SOURCEä¸­)
// Classes/services/NewService.h (åœ¨GAME_HEADERä¸­)
```

### æ·»åŠ æ–°çš„é…ç½®é¡¹
```cpp
// æ–‡ä»¶: GameConfig.h
struct NewSettings
{
    static const int NEW_VALUE;
    static const float NEW_SPEED;
};

// æ–‡ä»¶: GameConfig.cpp
const int GameConfig::NewSettings::NEW_VALUE = 100;
const float GameConfig::NewSettings::NEW_SPEED = 2.0f;
```

## ğŸ¨ èµ„æºæ–‡ä»¶ç®¡ç†

### æ·»åŠ æ–°å›¾ç‰‡èµ„æº
1. å°†å›¾ç‰‡æ”¾å…¥ `Resources/res/` ç›®å½•
2. åœ¨ `ResourceService.cpp` ä¸­æ·»åŠ è·¯å¾„å¸¸é‡
3. åœ¨ `preloadCardResources()` ä¸­æ·»åŠ é¢„åŠ è½½

```cpp
// ResourceService.h
static const std::string NEW_IMAGE;

// ResourceService.cpp
const std::string ResourceService::Paths::NEW_IMAGE = "res/new_image.png";

// åœ¨ preloadCardResources() ä¸­æ·»åŠ 
textureCache->addImage(Paths::NEW_IMAGE);
```

### æ›´æ¢å­—ä½“
1. å°†å­—ä½“æ–‡ä»¶æ”¾å…¥ `Resources/fonts/`
2. ä¿®æ”¹ `GameConfig.cpp` ä¸­çš„å­—ä½“è·¯å¾„
3. é‡æ–°ç¼–è¯‘è¿è¡Œ

```cpp
// GameConfig.cpp
const std::string GameConfig::ResourcePaths::FONT_PATH = "fonts/new_font.ttf";
```

## âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### 1. å‡å°‘å†…å­˜ä½¿ç”¨
```cpp
// åŠæ—¶æ¸…ç†ä¸ç”¨çš„çº¹ç†
Director::getInstance()->getTextureCache()->removeUnusedTextures();

// ä½¿ç”¨å¯¹è±¡æ± é¿å…é¢‘ç¹åˆ›å»ºé”€æ¯
static std::vector<CardView*> cardPool;
```

### 2. ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½
```cpp
// ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿçš„åŠ¨ç”»
auto action = MoveTo::create(0.5f, targetPos);  // æ¯” MoveBy æ›´é«˜æ•ˆ

// é¿å…åœ¨åŠ¨ç”»ä¸­é¢‘ç¹è®¡ç®—
auto preCalculatedAction = Sequence::create(action1, action2, nullptr);
```

### 3. èµ„æºé¢„åŠ è½½ç­–ç•¥
```cpp
// åˆ†æ‰¹é¢„åŠ è½½ï¼Œé¿å…å¯åŠ¨å¡é¡¿
void ResourceService::preloadEssentialResources()
{
    // åªåŠ è½½å¿…éœ€çš„èµ„æº
}

void ResourceService::preloadOptionalResources()
{
    // åå°åŠ è½½å¯é€‰èµ„æº
}
```

## ğŸ› å¸¸è§é”™è¯¯è§£å†³

### ç¼–è¯‘é”™è¯¯
```bash
# é”™è¯¯: undefined reference to 'xxx'
# è§£å†³: æ£€æŸ¥ CMakeLists.txt æ˜¯å¦åŒ…å«å¯¹åº”çš„ .cpp æ–‡ä»¶

# é”™è¯¯: No such file or directory
# è§£å†³: æ£€æŸ¥ #include è·¯å¾„æ˜¯å¦æ­£ç¡®

# é”™è¯¯: 'xxx' was not declared in this scope
# è§£å†³: æ£€æŸ¥æ˜¯å¦åŒ…å«å¯¹åº”çš„å¤´æ–‡ä»¶
```

### è¿è¡Œæ—¶é”™è¯¯
```cpp
// èµ„æºåŠ è½½å¤±è´¥
if (!ResourceService::isResourceExists("path/to/resource")) {
    CCLOG("Resource not found: %s", "path/to/resource");
}

// ç©ºæŒ‡é’ˆæ£€æŸ¥
if (cardView != nullptr) {
    cardView->doSomething();
}
```

## ğŸ“Š è°ƒè¯•æŠ€å·§

### æ·»åŠ è°ƒè¯•æ—¥å¿—
```cpp
// ä½¿ç”¨ CCLOG è¾“å‡ºè°ƒè¯•ä¿¡æ¯
CCLOG("Card matched: %s %d", cardModel.getSuitString().c_str(), cardModel.getValue());

// æ¡ä»¶è°ƒè¯•
#ifdef DEBUG
    CCLOG("Debug info: %d", someValue);
#endif
```

### æ€§èƒ½ç›‘æ§
```cpp
// ç›‘æ§å¸§ç‡
Director::getInstance()->setDisplayStats(true);

// ç›‘æ§å†…å­˜ä½¿ç”¨
auto textureCache = Director::getInstance()->getTextureCache();
CCLOG("Texture count: %d", textureCache->getCachedTextureInfo().size());
```

---

ğŸ’¡ **æç¤º**: ä¿®æ”¹ä»»ä½• .cpp æˆ– .h æ–‡ä»¶åéƒ½éœ€è¦é‡æ–°ç¼–è¯‘  
ğŸ”„ **ç¼–è¯‘å‘½ä»¤**: `cd linux-build && make`  
ğŸ§¹ **æ¸…ç†é‡å»º**: `cd linux-build && make clean && make`
