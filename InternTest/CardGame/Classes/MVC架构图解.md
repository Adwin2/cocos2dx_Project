# MVCæ¶æ„å›¾è§£ä¸æ•°æ®æµå‘

## ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åº”ç”¨ç¨‹åºå±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AppDelegate.cpp                                           â”‚
â”‚  â”œâ”€â”€ çª—å£åˆå§‹åŒ–                                              â”‚
â”‚  â”œâ”€â”€ èµ„æºé¢„åŠ è½½ (ResourceService::preloadCardResources)      â”‚
â”‚  â””â”€â”€ åœºæ™¯å¯åŠ¨ (CardGameSceneMVC::createScene)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        è§†å›¾å±‚ (Views)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CardGameSceneMVC.cpp (ä¸»åœºæ™¯)                              â”‚
â”‚  â”œâ”€â”€ UIåˆ›å»º (createUI)                                      â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·äº¤äº’å¤„ç†                                            â”‚
â”‚  â””â”€â”€ æ˜¾ç¤ºæ›´æ–°å›è°ƒ                                            â”‚
â”‚                                â”‚                            â”‚
â”‚  CardView.cpp (å¡ç‰Œè§†å›¾)                                    â”‚
â”‚  â”œâ”€â”€ å¡ç‰Œæ˜¾ç¤º (updateSprites)                               â”‚
â”‚  â”œâ”€â”€ åŠ¨ç”»æ•ˆæœ (playMatchAnimation)                          â”‚
â”‚  â””â”€â”€ è§¦æ‘¸äº‹ä»¶ (onTouchBegan)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ§åˆ¶å™¨å±‚ (Controllers)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  GameController.cpp                                        â”‚
â”‚  â”œâ”€â”€ æ¸¸æˆæµç¨‹æ§åˆ¶ (startNewGame, restartGame)                â”‚
â”‚  â”œâ”€â”€ ç”¨æˆ·æ“ä½œå¤„ç† (onCardClicked)                            â”‚
â”‚  â”œâ”€â”€ æ¨¡å‹è§†å›¾åè°ƒ                                            â”‚
â”‚  â””â”€â”€ äº‹ä»¶å›è°ƒç®¡ç†                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼           â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç®¡ç†å™¨å±‚    â”‚ â”‚   æœåŠ¡å±‚     â”‚ â”‚   æ¨¡å‹å±‚     â”‚
â”‚ (Managers)  â”‚ â”‚ (Services)  â”‚ â”‚  (Models)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š è¯¦ç»†åˆ†å±‚æ¶æ„

### 1. é…ç½®å±‚ (configs/)
```
GameConfig.h/cpp
â”œâ”€â”€ GameSettings (æ¸¸æˆåŸºç¡€é…ç½®)
â”œâ”€â”€ CardSettings (å¡ç‰Œå°ºå¯¸é…ç½®)
â”œâ”€â”€ UISettings (ç•Œé¢é…ç½®)
â”œâ”€â”€ ColorSettings (é¢œè‰²ä¸»é¢˜)
â”œâ”€â”€ PositionSettings (ä½ç½®é…ç½®)
â””â”€â”€ ResourcePaths (èµ„æºè·¯å¾„)

ä½œç”¨: é›†ä¸­ç®¡ç†æ‰€æœ‰é™æ€é…ç½®ï¼Œä¾¿äºè°ƒæ•´å’Œç»´æŠ¤
ä¾èµ–: æ—  (æœ€åº•å±‚)
è¢«ä¾èµ–: æ‰€æœ‰å…¶ä»–å±‚
```

### 2. æ¨¡å‹å±‚ (models/)
```
CardModel.h/cpp
â”œâ”€â”€ å¡ç‰Œæ•°æ® (èŠ±è‰²ã€æ•°å€¼ã€çŠ¶æ€)
â”œâ”€â”€ æ•°æ®æ“ä½œ (ç¿»ç‰Œã€æ¯”è¾ƒ)
â””â”€â”€ å­—ç¬¦ä¸²è½¬æ¢

GameModel.h/cpp
â”œâ”€â”€ æ¸¸æˆçŠ¶æ€ (åˆ†æ•°ã€å…³å¡ã€æ¸¸æˆçŠ¶æ€)
â”œâ”€â”€ å¡ç‰Œé›†åˆ (åº•ç‰Œã€ä¸»ç‰ŒåŒº)
â””â”€â”€ æ•°æ®ç®¡ç† (æ·»åŠ ã€åˆ é™¤ã€æŸ¥è¯¢)

ä½œç”¨: å­˜å‚¨è¿è¡Œæ—¶æ•°æ®ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
ä¾èµ–: configs/
è¢«ä¾èµ–: services/, managers/, controllers/
```

### 3. æœåŠ¡å±‚ (services/)
```
GameLogicService.h/cpp
â”œâ”€â”€ åŒ¹é…è§„åˆ™ (canMatch)
â”œâ”€â”€ å¾—åˆ†è®¡ç®— (calculateMatchScore)
â”œâ”€â”€ æ¸¸æˆç»“æŸåˆ¤æ–­ (checkGameOver)
â””â”€â”€ å¯ç”¨åŒ¹é…æŸ¥è¯¢ (getAvailableMatches)

CardGeneratorService.h/cpp
â”œâ”€â”€ éšæœºå¡ç‰Œç”Ÿæˆ (generateRandomCard)
â”œâ”€â”€ å®Œæ•´ç‰Œç»„ç”Ÿæˆ (generateFullDeck)
â”œâ”€â”€ æ´—ç‰Œç®—æ³• (shuffleCards)
â””â”€â”€ æ¸¸æˆåˆå§‹åŒ– (generateInitialCards)

ResourceService.h/cpp
â”œâ”€â”€ èµ„æºè·¯å¾„ç®¡ç† (getCardValueImagePath)
â”œâ”€â”€ èµ„æºç»„åˆ (getCardResources)
â”œâ”€â”€ èµ„æºé¢„åŠ è½½ (preloadCardResources)
â””â”€â”€ èµ„æºæ£€æŸ¥ (isResourceExists)

ä½œç”¨: æä¾›æ— çŠ¶æ€çš„ä¸šåŠ¡é€»è¾‘æœåŠ¡
ä¾èµ–: models/, configs/
è¢«ä¾èµ–: controllers/, managers/
```

### 4. è§†å›¾å±‚ (views/)
```
CardView.h/cpp
â”œâ”€â”€ å¡ç‰Œæ˜¾ç¤º (updateSprites)
â”œâ”€â”€ åŠ¨ç”»æ•ˆæœ (playMatchAnimation, playMismatchAnimation)
â”œâ”€â”€ ç”¨æˆ·äº¤äº’ (initTouchEvents, onTouchBegan)
â”œâ”€â”€ çŠ¶æ€åˆ‡æ¢ (setFaceUp, setHighlighted)
â””â”€â”€ èµ„æºæ›´æ–° (updateCardResources)

ä½œç”¨: è´Ÿè´£ç•Œé¢æ˜¾ç¤ºå’Œç”¨æˆ·äº¤äº’ï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘
ä¾èµ–: models/, services/, configs/
è¢«ä¾èµ–: managers/
```

### 5. ç®¡ç†å™¨å±‚ (managers/)
```
CardViewManager.h/cpp
â”œâ”€â”€ è§†å›¾ç”Ÿå‘½å‘¨æœŸ (createCardView, removeCardView)
â”œâ”€â”€ å¸ƒå±€ç®¡ç† (layoutCards, calculatePosition)
â”œâ”€â”€ åŠ¨ç”»åè°ƒ (playMatchAnimation, highlightMatchableCards)
â”œâ”€â”€ æ‰¹é‡æ“ä½œ (updateFromGameModel, clearAllCardViews)
â””â”€â”€ äº‹ä»¶è½¬å‘ (onCardClicked)

ä½œç”¨: ç®¡ç†è§†å›¾ç»„ä»¶ï¼Œä½œä¸ºæ§åˆ¶å™¨çš„æˆå‘˜å˜é‡
ä¾èµ–: views/, models/, configs/
è¢«ä¾èµ–: controllers/
```

### 6. æ§åˆ¶å™¨å±‚ (controllers/)
```
GameController.h/cpp
â”œâ”€â”€ æ¸¸æˆæµç¨‹ (startNewGame, restartGame, pauseGame)
â”œâ”€â”€ ç”¨æˆ·æ“ä½œ (onCardClicked, showHint, clearHints)
â”œâ”€â”€ æ¨¡å‹æ›´æ–° (handleCardMatch, generateNewBottomCard)
â”œâ”€â”€ è§†å›¾åŒæ­¥ (updateViews, handleMatchSuccess)
â”œâ”€â”€ äº‹ä»¶å›è°ƒ (notifyScoreUpdate, notifyGameWin)
â””â”€â”€ çŠ¶æ€ç®¡ç† (checkGameEnd, setLevel)

ä½œç”¨: åè°ƒå„å±‚ï¼Œå¤„ç†æ¸¸æˆä¸»è¦æµç¨‹
ä¾èµ–: æ‰€æœ‰å…¶ä»–å±‚
è¢«ä¾èµ–: views/ (ä¸»åœºæ™¯)
```

### 7. ä¸»åœºæ™¯ (CardGameSceneMVC)
```
CardGameSceneMVC.h/cpp
â”œâ”€â”€ UIåˆ›å»º (createUI, createLabels, createMenu)
â”œâ”€â”€ æ§åˆ¶å™¨åˆå§‹åŒ– (initGameController, setupControllerCallbacks)
â”œâ”€â”€ æ˜¾ç¤ºæ›´æ–° (updateScoreDisplay, updateGameStatusDisplay)
â”œâ”€â”€ ç”¨æˆ·äº¤äº’ (onRestartClicked, onHintClicked)
â””â”€â”€ æ¶ˆæ¯æ˜¾ç¤º (showMessage, hideMessage)

ä½œç”¨: æ¸¸æˆä¸»ç•Œé¢ï¼Œè¿æ¥ç”¨æˆ·å’Œæ§åˆ¶å™¨
ä¾èµ–: controllers/, configs/
è¢«ä¾èµ–: AppDelegate
```

## ğŸ”„ æ•°æ®æµå‘å›¾

### ç”¨æˆ·ç‚¹å‡»å¡ç‰Œçš„å®Œæ•´æµç¨‹:

```
1. ç”¨æˆ·ç‚¹å‡»
   CardView::onTouchBegan()
   â”‚
   â–¼
2. äº‹ä»¶è½¬å‘
   CardViewManager::onCardClicked()
   â”‚
   â–¼
3. æ§åˆ¶å™¨å¤„ç†
   GameController::onCardClicked()
   â”‚
   â–¼
4. ä¸šåŠ¡é€»è¾‘
   GameLogicService::processCardMatch()
   â”‚
   â”œâ”€â”€ GameLogicService::canMatch() (æ£€æŸ¥åŒ¹é…)
   â”œâ”€â”€ GameModel::removeMainCardById() (æ›´æ–°æ•°æ®)
   â”œâ”€â”€ GameModel::addScore() (æ›´æ–°åˆ†æ•°)
   â””â”€â”€ GameLogicService::checkGameOver() (æ£€æŸ¥ç»“æŸ)
   â”‚
   â–¼
5. è§†å›¾æ›´æ–°
   GameController::handleMatchSuccess()
   â”‚
   â”œâ”€â”€ CardViewManager::playMatchAnimation() (æ’­æ”¾åŠ¨ç”»)
   â”œâ”€â”€ CardGeneratorService::generateNewBottomCard() (ç”Ÿæˆæ–°åº•ç‰Œ)
   â””â”€â”€ CardGameSceneMVC::onScoreUpdate() (æ›´æ–°UI)
```

### æ¸¸æˆåˆå§‹åŒ–æµç¨‹:

```
1. åº”ç”¨å¯åŠ¨
   AppDelegate::applicationDidFinishLaunching()
   â”‚
   â”œâ”€â”€ ResourceService::preloadCardResources() (é¢„åŠ è½½èµ„æº)
   â””â”€â”€ CardGameSceneMVC::createScene() (åˆ›å»ºåœºæ™¯)
   â”‚
   â–¼
2. åœºæ™¯åˆå§‹åŒ–
   CardGameSceneMVC::init()
   â”‚
   â”œâ”€â”€ createUI() (åˆ›å»ºç•Œé¢)
   â””â”€â”€ initGameController() (åˆå§‹åŒ–æ§åˆ¶å™¨)
   â”‚
   â–¼
3. æ§åˆ¶å™¨åˆå§‹åŒ–
   GameController::init()
   â”‚
   â””â”€â”€ CardViewManager::new() (åˆ›å»ºè§†å›¾ç®¡ç†å™¨)
   â”‚
   â–¼
4. æ¸¸æˆå¼€å§‹
   GameController::startNewGame()
   â”‚
   â”œâ”€â”€ GameModel::reset() (é‡ç½®æ•°æ®)
   â”œâ”€â”€ CardGeneratorService::generateInitialCards() (ç”Ÿæˆå¡ç‰Œ)
   â””â”€â”€ CardViewManager::updateFromGameModel() (æ›´æ–°è§†å›¾)
```

## ğŸ”— ä¾èµ–å…³ç³»å›¾

```
AppDelegate
    â”‚
    â–¼
CardGameSceneMVC â”€â”€â”€â”€â”€â”€â”
    â”‚                 â”‚
    â–¼                 â–¼
GameController â”€â”€â”€â”€â–º configs/
    â”‚
    â”œâ”€â”€â–º managers/ â”€â”€â–º views/ â”€â”€â”
    â”‚                          â”‚
    â”œâ”€â”€â–º services/ â”€â”€â–º models/ â”€â”¤
    â”‚                          â”‚
    â””â”€â”€â–º configs/ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ä¿®æ”¹å½±å“èŒƒå›´

| ä¿®æ”¹ä½ç½® | å½±å“èŒƒå›´ | é‡æ–°ç¼–è¯‘ | æ³¨æ„äº‹é¡¹ |
|---------|---------|---------|---------|
| configs/ | å…¨éƒ¨æ¨¡å— | âœ… | å½±å“æœ€å¹¿ï¼Œéœ€è¦å…¨é¢æµ‹è¯• |
| models/ | services+, managers+, controllers+ | âœ… | æ•°æ®ç»“æ„å˜æ›´éœ€è¦åŒæ­¥æ›´æ–° |
| services/ | controllers+, managers+ | âœ… | ä¸šåŠ¡é€»è¾‘å˜æ›´éœ€è¦æµ‹è¯• |
| views/ | managers+ | âœ… | ç•Œé¢å˜æ›´ç›¸å¯¹å®‰å…¨ |
| managers/ | controllers+ | âœ… | ç®¡ç†é€»è¾‘å˜æ›´éœ€è¦æµ‹è¯• |
| controllers/ | ä¸»åœºæ™¯ | âœ… | æµç¨‹å˜æ›´éœ€è¦å…¨é¢æµ‹è¯• |

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å•ä¸€èŒè´£åŸåˆ™
- æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„åŠŸèƒ½
- configs/ åªå­˜é…ç½®ï¼Œä¸å«é€»è¾‘
- services/ åªå«é€»è¾‘ï¼Œä¸å­˜çŠ¶æ€

### 2. ä¾èµ–å€’ç½®åŸåˆ™
- é«˜å±‚æ¨¡å—ä¸ä¾èµ–ä½å±‚æ¨¡å—
- é€šè¿‡æ¥å£å’Œå›è°ƒè§£è€¦

### 3. å¼€é—­åŸåˆ™
- å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
- æ–°åŠŸèƒ½é€šè¿‡æ·»åŠ æ–°ç±»å®ç°

### 4. æ¥å£éš”ç¦»åŸåˆ™
- ä½¿ç”¨å›è°ƒå‡½æ•°è€Œéå¤§æ¥å£
- æ¯ä¸ªå›è°ƒåªè´Ÿè´£ä¸€ä¸ªäº‹ä»¶

---

ğŸ“ **æ¶æ„è®¾è®¡**: MVC + åˆ†å±‚æ¶æ„  
ğŸ”„ **æ•°æ®æµå‘**: å•å‘æ•°æ®æµ  
ğŸ¯ **è®¾è®¡åŸåˆ™**: SOLID åŸåˆ™
